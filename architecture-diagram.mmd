flowchart TD
    subgraph "AWS Cloud - eu-north-1"
        subgraph "VPC - 10.0.0.0/16"
            subgraph "Availability Zone A - eu-north-1a"
                PublicSubnetA["Public Subnet A\n10.0.1.0/24"]
                PrivateSubnetA["Private Subnet A\n10.0.11.0/24"]
            end
            
            subgraph "Availability Zone B - eu-north-1b"
                PublicSubnetB["Public Subnet B\n10.0.2.0/24"]
                PrivateSubnetB["Private Subnet B\n10.0.12.0/24"]
            end
            
            IGW["Internet Gateway"]
            NATGW["NAT Gateway"]
            EIP["Elastic IP"]
            
            PublicRT["Public Route Table"]
            PrivateRT["Private Route Table"]
            
            PublicSubnetA --> PublicRT
            PublicSubnetB --> PublicRT
            PrivateSubnetA --> PrivateRT
            PrivateSubnetB --> PrivateRT
            
            PublicRT --> IGW
            PrivateRT --> NATGW
            NATGW --> EIP
            EIP --> IGW
            IGW --> Internet((Internet))
        end
        
        subgraph "Amazon EKS"
            EKSCluster["EKS Cluster\nVersion: 1.32\ncloud-design-cluster"]
            
            subgraph "Node Group"
                EKSNode1["EKS Node 1\nt3.large (SPOT)"]
                EKSNode2["EKS Node 2\nt3.large (SPOT)"]
            end
            
            subgraph "Kubernetes Resources"
                OIDC["OIDC Provider"]
                
                subgraph "Workloads"
                    APIGateway["API Gateway"]
                    InventoryApp["Inventory App"]
                    BillingApp["Billing App"]
                    BillingQueue["RabbitMQ\n(Billing Queue)"]
                    InventoryDB["Inventory DB"]
                    BillingDB["Billing DB"]
                end
                
                subgraph "Add-ons"
                    ALBController["AWS Load Balancer\nController"]
                    MetricsServer["Metrics Server"]
                    ContainerInsights["Container Insights"]
                end
                
                APIGateway --> InventoryApp
                APIGateway --> BillingQueue
                BillingQueue --> BillingApp
                InventoryApp --> InventoryDB
                BillingApp --> BillingDB
            end
            
            ALB["Application Load Balancer"]
            ALBController --> ALB
            ALB --> APIGateway
            
            EKSCluster --> OIDC
            EKSNode1 --> PrivateSubnetA
            EKSNode2 --> PrivateSubnetB
        end
        
        IAMRoles["IAM Roles & Policies"]
        S3Bucket["S3 Bucket\n(Terraform State)"]
        DynamoDB["DynamoDB Table\n(State Locking)"]
        ACMCert["ACM Certificate\nSelf-Signed"]
        CWDashboard["CloudWatch\nDashboard"]
        
        IAMRoles --> EKSCluster
        IAMRoles --> ALBController
        IAMRoles --> ContainerInsights
        
        EKSCluster --> CWDashboard
        ContainerInsights --> CWDashboard
        ALB --> ACMCert
        
        Internet --> ALB
    end
